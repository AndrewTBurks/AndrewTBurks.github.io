<!DOCTYPE html>
<meta charset="utf-8">
<style>

* {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-weight: bold;	
}

.color {
	stroke: gray;
	stroke-width: 1px;
}

.color:hover {
	stroke: yellow;
	stroke-width: 2px;
}

</style>

<body>
	<iframe src="navbar.html?wmode=opaque" class="navbar" width=100% height=175 frameBorder="0" scrolling="no"></iframe>
	<p class = "colorInfo">Color:</p>
	<!-- <input type = "text" name = "rectCount" onchange="redraw()"> -->
</body>

<script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="cubehelix.js"></script>
<script>

var data = [];

var width = 800,
	height = 400,
	numRects = 10, 
	spacing = 3,
	maxRowSize = 20;

var numWide = numRects > maxRowSize ? maxRowSize : numRects;

var colorWidth = (width-(spacing*(numWide+1)))/numWide;

height = (spacing) + ((colorWidth + spacing) * Math.ceil(numRects/maxRowSize));

// Color Scales from Mike Bostock: https://bl.ocks.org/mbostock/11415064

// Default
var cDef = d3.scale.cubehelix()
	.domain([0, numRects]);

// Reversed
var cRev = d3.scale.cubehelix()
    .domain([numRects, 0]);

// Hue [276°, 96°]
var c3 = d3.scale.cubehelix()
    .domain([0, numRects])
    .range([d3.hsl(276, .6, 0), d3.hsl(96, .6, 1)]);

// Hue [-120°, 60°]
var c4 = d3.scale.cubehelix()
    .domain([0, numRects])
    .range([d3.hsl(-120, .6, 0), d3.hsl(60, .6, 1)]);

//Hue [-40°, 60°, 160]
var c5 = d3.scale.cubehelix()
    .domain([0, numRects/2, numRects])
    .range([d3.hsl(-40, .6, .3), d3.hsl(60, .6, 1), d3.hsl(160, .6, .3)]);

// Rainbow
var cRain = d3.scale.cubehelix()
    .domain([0, numRects])
    .range([d3.hsl(270, .75, .35), d3.hsl(70, 1.5, .8)]);

var info = d3.select(".colorInfo");

var svg = d3.select("body").append("svg")
	.attr("width", "100%")
	.attr("height", 600);

var background = svg.append("rect")
	.attr("width", width)
	.attr("height", height)
	.style("fill", "black");

var rects;

draw(numRects);

function maxRowLen(num) {

	maxRowSize = num;
	draw(numRects);
}

function redraw() {
	var result = Math.round(parseFloat(d3.select("input")));

	draw(result);
}

function draw(num) {

	numRects = num;

	// reset color scale domains
	cDef.domain([0, numRects]);
	cRev.domain([numRects, 0]);
	c3.domain([0, numRects]);
	c4.domain([0, numRects]);
	c5.domain([0, numRects/2, numRects]);
	cRain.domain([0, numRects]);

	numWide = numRects > maxRowSize ? maxRowSize : numRects;

	colorWidth = (width-(spacing*(numWide+1)))/numWide;

	height = (spacing) + ((colorWidth + spacing) * Math.ceil(numRects/maxRowSize));

	// change height of to new height
	background.attr("height", height);


	if (rects) {
		d3.selectAll(".color").remove();
	}

	data = [];
	for(i = 0; i < numRects; i++){
		data.push(Math.random());
	}

	rects = svg.selectAll(".color")
		.data(data)
	  	  .enter().append("rect")
		.attr("class", "color")
		.attr({ width : colorWidth,
				height : colorWidth})
		.attr("x", function(d, i) {
			return Math.floor(i/maxRowSize) % 2 === 1 ? 
			(width-colorWidth-spacing) - ((i%maxRowSize) * (colorWidth+spacing))
			: ((spacing) + ((i%maxRowSize) * (colorWidth+spacing)));
		})
		.attr("y", function(d, i) {
			return (spacing) + ((colorWidth+spacing) * Math.floor((i/maxRowSize)));
		})
		.style("fill", function(d, i) {
			return cDef(i);
		})
		.on("click", function(d, i) { 
			info.text("Color: " + cDef(i))
			console.log(i, cDef(i)); 
		});
}


</script>